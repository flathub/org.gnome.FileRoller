{
    "id": "org.gnome.FileRoller",
    "runtime": "org.gnome.Platform",
    "runtime-version": "49",
    "sdk": "org.gnome.Sdk",
    "command": "file-roller",
    "finish-args": [
        "--device=dri",
        "--share=ipc",
        "--socket=fallback-x11",
        "--socket=wayland",
        "--filesystem=home",
        "--metadata=X-DConf=migrate-path=/org/gnome/file-roller/",
        "--own-name=org.gnome.ArchiveManager1"
    ],
    "cleanup": [
        "/share/man"
    ],
    "modules": [
        {
            "name": "p7zip",
            "no-autogen": true,
            "make-args": [
                "7z"
            ],
            "make-install-args": [
                "DEST_HOME=/app"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/p7zip-project/p7zip/archive/refs/tags/v17.05.tar.gz",
                    "sha256": "d2788f892571058c08d27095c22154579dfefb807ebe357d145ab2ddddefb1a6",
                    "x-checker-data": {
                        "type": "json",
                        "url": "https://api.github.com/repos/p7zip-project/p7zip/releases/latest",
                        "version-query": ".tag_name",
                        "url-query": "\"https://github.com/p7zip-project/p7zip/archive/refs/tags/\\($version).tar.gz\""
                    }
                }
            ]
        },
        {
            "name": "unrar",
            "no-autogen": true,
            "build-options": {
                "strip": true
            },
            "make-install-args": [
                "DESTDIR=$(FLATPAK_DEST)"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://www.rarlab.com/rar/unrarsrc-7.1.10.tar.gz",
                    "sha256": "72a9ccca146174f41876e8b21ab27e973f039c6d10b13aabcb320e7055b9bb98",
                    "x-checker-data": {
                        "type": "anitya",
                        "project-id": 13306,
                        "url-template": "https://www.rarlab.com/rar/unrarsrc-$version.tar.gz"
                    }
                }
            ]
        },
        {
            "name": "zstd",
            "buildsystem": "meson",
            "subdir": "build/meson",
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/facebook/zstd/releases/download/v1.5.7/zstd-1.5.7.tar.gz",
                    "sha256": "eb33e51f49a15e023950cd7825ca74a4a2b43db8354825ac24fc1b7ee09e6fa3",
                    "x-checker-data": {
                        "type": "json",
                        "url": "https://api.github.com/repos/facebook/zstd/releases/latest",
                        "version-query": ".tag_name | sub(\"^v|\"; \"\")",
                        "url-query": ".assets[] | select(.name==\"zstd-\" + $version + \".tar.gz\") | .browser_download_url"
                    }
                }
            ]
        },
        {
            "name": "rpm2cpio",
            "buildsystem": "simple",
            "build-commands": [
                "install -D rpm2cpio.py /app/bin/rpm2cpio"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/ruda/rpm2cpio/archive/2017.tar.gz",
                    "sha256": "d266a4f49e65b5d05956502549ceb1d5671f927375ff71299069e6d92363297a"
                },
                {
                    "type": "patch",
                    "path": "rpm2cpio.patch"
                }
            ]
        },
        {
            "name": "libportal",
            "buildsystem": "meson",
            "config-opts": [
                "-Ddocs=false",
                "-Dvapi=false",
                "-Dtests=false",
                "-Dintrospection=false",
                "-Dbackend-gtk3=disabled",
                "-Dbackend-qt5=disabled",
                "-Dbackend-gtk4=enabled"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://github.com/flatpak/libportal/releases/download/0.9.1/libportal-0.9.1.tar.xz",
                    "sha256": "de801ee349ed3c255a9af3c01b1a401fab5b3fc1c35eb2fd7dfb35d4b8194d7f",
                    "x-checker-data": {
                        "type": "json",
                        "url": "https://api.github.com/repos/flatpak/libportal/releases/latest",
                        "version-query": ".tag_name",
                        "url-query": ".assets[] | select(.name==\"libportal-\" + $version + \".tar.xz\") | .browser_download_url"
                    }
                }
            ]
        },
        {
            "name": "file-roller",
            "buildsystem": "meson",
            "config-opts": [
                "-Duse_native_appchooser=true"
            ],
            "cleanup": [
                "org.gnome.FileRoller.ArchiveManager1.service"
            ],
            "sources": [
                {
                    "type": "archive",
                    "url": "https://download.gnome.org/sources/file-roller/44/file-roller-44.5.tar.xz",
                    "sha256": "dfaf4bb989c0b8986be8bdae9fffeab8d0f30669ae3a627e8c3df94f23888339",
                    "x-checker-data": {
                        "type": "gnome",
                        "is-important": true,
                        "name": "file-roller"
                    }
                }
            ]
        }
    ]
}
